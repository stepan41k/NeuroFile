<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Neuro File</title>

		<!-- Fonts: Inter (UI) & Lora (Headings) -->
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Lora:ital,wght@0,400;0,500;1,400&display=swap"
			rel="stylesheet"
		/>

		<!-- Bootstrap Icons -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
		/>
		<!-- Bootstrap 5 Grid -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>

		<!-- Стили для подсветки кода (тема Atom One Dark) -->
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css"
		/>
		<!-- Скрипт подсветки -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

		<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
		<link rel="stylesheet" href="/src/style.css" />
	</head>
	<body>
		<!-- Auth Overlay -->
		<div id="authOverlay" class="auth-overlay">
			<div class="auth-box">
				<h2 class="display-font text-white mb-2 text-center">Neuro File</h2>
				<p class="text-center mb-4 small" id="authSubtitle">
					Login to your workspace
				</p>

				<!-- Сообщения об ошибках/успехе -->
				<div
					id="authMessage"
					class="alert d-none small p-2 mb-3 text-center"
				></div>

				<!-- Login Form -->
				<form id="loginForm" class="auth-form active">
					<div class="mb-3">
						<input
							type="text"
							id="loginUser"
							class="form-control custom-input-auth"
							placeholder="Username"
							required
						/>
					</div>
					<div class="mb-3">
						<input
							type="password"
							id="loginPass"
							class="form-control custom-input-auth"
							placeholder="Password"
							required
						/>
					</div>
					<button type="submit" class="btn btn-accent w-100 mb-3" id="loginBtn">
						<span class="btn-text">Log In</span>
						<span
							class="spinner-border spinner-border-sm d-none"
							role="status"
						></span>
					</button>
					<div class="text-center">
						<span class="small">No account? </span>
						<a href="#" id="toRegisterLink" class="text-accent small fw-bold"
							>Sign up</a
						>
					</div>
				</form>

				<!-- Register Form -->
				<form id="registerForm" class="auth-form d-none">
					<div class="mb-3">
						<input
							type="text"
							id="regUser"
							class="form-control custom-input-auth"
							placeholder="Choose Username"
							required
						/>
					</div>
					<div class="mb-3">
						<input
							type="password"
							id="regPass"
							class="form-control custom-input-auth"
							placeholder="Password (min 6 chars)"
							required
						/>
					</div>
					<div class="mb-3">
						<input
							type="password"
							id="regPassConfirm"
							class="form-control custom-input-auth"
							placeholder="Confirm Password"
							required
						/>
					</div>
					<button type="submit" class="btn btn-accent w-100 mb-3" id="regBtn">
						<span class="btn-text">Create Account</span>
						<span
							class="spinner-border spinner-border-sm d-none"
							role="status"
						></span>
					</button>
					<div class="text-center">
						<span class="small">Already have an account? </span>
						<a href="#" id="toLoginLink" class="text-accent small fw-bold"
							>Log in</a
						>
					</div>
				</form>
			</div>
		</div>

		<div class="app-layout">
			<!-- Left Sidebar -->
			<nav class="sidebar">
				<div class="sidebar-top">
					<a href="#" class="new-chat-btn" title="New Chat">
						<i class="bi bi-plus-lg"></i>
						<span>New chat</span>
					</a>

					<div class="nav-icons" id="historyList">
						<a href="#" class="nav-item">
							<i class="bi bi-clock-history"></i>
							<span>History</span>
						</a>
					</div>
				</div>

				<div class="sidebar-bottom position-relative">
					<!-- Меню выхода (Скрыто по умолчанию) -->
					<div id="profileMenu" class="profile-menu d-none">
						<button id="confirmLogoutBtn" class="menu-item text-danger mb-0">
							<i class="bi bi-box-arrow-right"></i>
							Log out
						</button>
					</div>

					<!-- Кнопка профиля -->
					<a href="#" class="nav-item profile" id="userProfileBtn">
						<div class="avatar">U</div>
						<span id="usernameDisplay">User</span>
					</a>
				</div>
			</nav>

			<!-- Main Content -->
			<main class="main-area">
				<div class="chat-scroll-area" id="chatContainer">
					<!-- Welcome Screen -->
					<div class="welcome-screen fade-in">
						<div class="welcome-content">
							<h1 class="display-font">How can I help you today?</h1>
						</div>
					</div>
				</div>

				<!-- Floating Input -->
				<div class="input-dock">
					<div class="input-container">
						<!-- ВЕРХНИЙ РЯД: Поле ввода + Кнопка отправки -->
						<div class="input-row-top">
							<textarea
								id="userInput"
								class="chat-input"
								placeholder="Message Neuro..."
								rows="1"
							></textarea>

							<div class="right-actions">
								<button class="send-btn" id="sendBtn">
									<i class="bi bi-arrow-up-short"></i>
								</button>
							</div>
						</div>

						<!-- НИЖНИЙ РЯД: Скрепка + Переключатель -->
						<div class="input-row-bottom">
							<div class="left-actions">
								<!-- Кнопка скрепки -->
								<button
									class="icon-btn"
									title="Attach file"
									onclick="document.getElementById('fileInput').click()"
								>
									<i class="bi bi-paperclip"></i>
								</button>

								<!-- Разделитель -->
								<div
									style="
										width: 1px;
										height: 16px;
										background: rgba(255, 255, 255, 0.1);
										margin: 0 4px;
									"
								></div>

								<!-- Переключатель -->
								<label
									class="toggle-wrapper"
									title="Enable strict conflict analysis"
								>
									<input
										type="checkbox"
										id="conflictsToggle"
										class="toggle-checkbox"
									/>

									<div class="toggle-label">
										<span class="toggle-switch"></span>
									</div>

									<span class="toggle-text">Conflicts</span>
								</label>
							</div>
						</div>
					</div>
				</div>
				<div class="footer-text">
					<!-- AI generates simulated responses for UI testing. -->
				</div>
			</main>

			<!-- Right Sidebar: Files -->
			<aside class="right-sidebar">
				<!-- Header -->
				<div class="sidebar-header mb-2">
					<h6 class="text-uppercase mb-0 small fw-bold">My Files</h6>
					<button class="icon-btn-small" title="Refresh">
						<i class="bi bi-arrow-clockwise"></i>
					</button>
				</div>

				<!-- Search & Filter Area (NEW) -->
				<div class="search-filter-container">
					<!-- Search Input -->
					<div class="search-wrapper mb-2">
						<i class="bi bi-search small"></i>
						<input
							type="text"
							id="fileSearchInput"
							class="file-search-input"
							placeholder="Find file..."
						/>
					</div>

					<!-- Filter Tags -->
					<div class="filter-scroll" id="filterContainer">
						<span class="filter-tag active" data-type="all">All</span>
						<span class="filter-tag" data-type="pdf">PDF</span>

						<!-- ИЗМЕНЕНИЕ ЗДЕСЬ: Два отдельных тега -->
						<span class="filter-tag" data-type="doc">DOC</span>
						<span class="filter-tag" data-type="docx">DOCX</span>

						<span class="filter-tag" data-type="rtf">RTF</span>
					</div>
				</div>

				<!-- File List -->
				<div class="file-list-container mt-2" id="fileListContainer">
					<!-- Файлы будут рендериться здесь через JS -->
				</div>

				<!-- Upload Area (Оставляем как было) -->
				<div class="upload-area mt-auto">
					<label for="fileInput" class="upload-box">
						<i class="bi bi-cloud-arrow-up text-accent mb-2 fs-3"></i>
						<span class="small">Upload File</span>
						<!-- УБРАЛИ атрибут accept -->
						<input type="file" id="fileInput" hidden />
					</label>
				</div>
			</aside>
		</div>

		<script type="module" src="/src/main.ts"></script>
	</body>
</html>
